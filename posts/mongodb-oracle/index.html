<!DOCTYPE html>
<head>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    
    <link rel="icon" type="image/png" href="/images/favicon.png" />
<link rel="shortcut icon" type="image/png" href="/images/favicon.png" />

    
    
    <title>MongoDB与OracleDB效率测试 - 聽的资料</title>
    
    
    <meta name="author" content="sohunjug" /> 
     
    
    
    <meta name="keywords" content="MongoDB, Oracle" />
    
    <meta property="og:title" content="MongoDB与OracleDB效率测试" />
<meta property="og:description" content="最近因为任务需要，专门调研了一下MongoDB数据库的效率。与常规的OracleDB做了一下对比。
MongoDB是一个基于分布式文件存储的数据库。由C&#43;&#43;语言编写。旨在为WEB应用提供可扩展的高性能数据存储解决方案。
他支持的数据结构非常松散，是类似json的bjson格式，因此可以存储比较复杂的数据类型。Mongo最大的特点是他支持的查询语言非常强大，其语法有点类似于面向对象的查询语言，几乎可以实现类似关系数据库单表查询的绝大部分功能，而且还支持对数据建立索引。
Mongodb的存储方式是文档式存储，并不是Key-Value形式。
Mongodb的主要的三种集群方式的搭建：Replica Set、 Sharding、 Master-Slaver。
其他大部分内容互联网上也有很多，我也就不再做介绍了。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://sohunjug.com/posts/mongodb-oracle/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2013-08-26T00:00:00+08:00" />
<meta property="article:modified_time" content="2013-08-26T00:00:00+08:00" />

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="MongoDB与OracleDB效率测试"/>
<meta name="twitter:description" content="最近因为任务需要，专门调研了一下MongoDB数据库的效率。与常规的OracleDB做了一下对比。
MongoDB是一个基于分布式文件存储的数据库。由C&#43;&#43;语言编写。旨在为WEB应用提供可扩展的高性能数据存储解决方案。
他支持的数据结构非常松散，是类似json的bjson格式，因此可以存储比较复杂的数据类型。Mongo最大的特点是他支持的查询语言非常强大，其语法有点类似于面向对象的查询语言，几乎可以实现类似关系数据库单表查询的绝大部分功能，而且还支持对数据建立索引。
Mongodb的存储方式是文档式存储，并不是Key-Value形式。
Mongodb的主要的三种集群方式的搭建：Replica Set、 Sharding、 Master-Slaver。
其他大部分内容互联网上也有很多，我也就不再做介绍了。"/>


    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/disqusjs@1.3.0/dist/disqusjs.css" />
    
    

    
    
    <link rel="stylesheet" href="https://sohunjug.com/scss/main.min.3796779d99b798f0ae24d49c5a420db134eef2207610ed71453e417ce3ab44ed.css" integrity="sha256-N5Z3nZm3mPCuJNScWkINsTTu8iB2EO1xRT5BfOOrRO0=" crossorigin="anonymous" media="screen">
	<link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
</head>
  
</head>
<body>
  <span class="mobile btn-mobile-menu">

    <i class="fa fa-list btn-mobile-menu__icon"></i>
    <i class="fa fa-angle-up btn-mobile-close__icon hidden"></i>

  </span>

  <header class="  panel-cover panel-cover--collapsed " style="background-image: url('/images/background-cover.jpg')">

    <div class="panel-main">
  
      <div class="panel-main__inner panel-inverted">
      <div class="panel-main__content">
  
          <a href="/#blog" title="Homepage of 聽的资料 " class="blog-button"><img src="/images/avatar.jpg" width="80" alt="聽的资料 logo" class="panel-cover__logo logo" /></a>
          <h1 class="panel-cover__title panel-title"><a href="/#blog" title="Homepage of 聽的资料" class="blog-button">聽的资料</a></h1>
          
          <span class="panel-cover__subtitle panel-subtitle">Opportunity favors only the prepared mind. And everything change with time.</span>
          
          <hr class="panel-cover__divider" />
          <p class="panel-cover__description"></p>
          <hr class="panel-cover__divider panel-cover__divider--secondary" />
          
          
          
          <div class="navigation-wrapper">
            <div>
              <nav class="cover-navigation cover-navigation--primary">
                <ul class="navigation">
                  <li class="navigation__item"><a href="/#blog" title="Blog" class="blog-button">Blog</a></li>
                  
                    <li class="navigation__item"><a href="/tags/" target="_blank" title="Tags">Tags</a></li>
                  
                </ul>
              </nav>
            </div>
            
            <div><nav class="cover-navigation navigation--social">
    <ul class="navigation">
  
    
    
    <li class="navigation__item">
      <a href="http://weibo.com/sohunjug" title="@sohunjug" target="_blank">
        <i class='social fa fa-weibo'></i>
        <span class="label">Weibo</span>
      </a>
    </li>
    
  
    
    
    <li class="navigation__item">
      <a href="https://github.com/sohunjug" title="@sohunjug" target="_blank">
        <i class='social fa fa-github'></i>
        <span class="label">Github</span>
      </a>
    </li>
    
    
    
    
    <li class="navigation__item">
      <a href="https://twitter.com/sohunjug" title="@sohunjug" target="_blank">
        <i class='social fa fa-twitter'></i>
        <span class="label">Twitter</span>
      </a>
    </li>
    

    
  
    
  
    
    <li class="navigation__item">
      <a href="/index.xml" rel="author" title="RSS" target="_blank">
        <i class='social fa fa-rss'></i>
        <span class="label">RSS</span>
      </a>
    </li>
  
    
    
    <li class="navigation__item">
      <a href="mailto:sohunjug@gmail.com" title="Contact me">
        <i class='social fa fa-envelope'></i>
        <span class="label">Email</span>
      </a>
    </li>
    
  
    </ul>
  </nav>
  </div>
          </div>
        </div>
      </div>
      
      
      <div class="panel-cover--overlay cover-red"></div>
      
    </div>
  </header>
  

  <div class="content-wrapper">
    <div class="content-wrapper__inner">

        
<article class="post-container post-container--single" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <div class="post-meta">
            <time datetime=" 2013-08-26 00:00:00 &#43;0800 " itemprop="datePublished" class="post-meta__date date">2013-08-26</time>
             <span class="post-meta__tags tags">   • <a href="https://sohunjug.com/tags/mongodb">MongoDB</a>   • <a href="https://sohunjug.com/tags/oracle">Oracle</a>  </span> 
        </div>
        <h1 class="post-title">MongoDB与OracleDB效率测试</h1>
    </header>
    <section class="post">
        <p>最近因为任务需要，专门调研了一下MongoDB数据库的效率。与常规的OracleDB做了一下对比。</p>
<p>MongoDB是一个基于分布式文件存储的数据库。由C++语言编写。旨在为WEB应用提供可扩展的高性能数据存储解决方案。
他支持的数据结构非常松散，是类似json的bjson格式，因此可以存储比较复杂的数据类型。Mongo最大的特点是他支持的查询语言非常强大，其语法有点类似于面向对象的查询语言，几乎可以实现类似关系数据库单表查询的绝大部分功能，而且还支持对数据建立索引。
Mongodb的存储方式是文档式存储，并不是Key-Value形式。
Mongodb的主要的三种集群方式的搭建：Replica Set、 Sharding、 Master-Slaver。
其他大部分内容互联网上也有很多，我也就不再做介绍了。</p>
<p>主要测试时设备环境以及数据格式</p>
<p><strong>设备环境</strong></p>
<p><em>175、176服务器：</em></p>
<p><em>CPU：8核</em></p>
<p><em>内存：32G（空闲19G）</em></p>
<p><em>硬盘：4TB</em></p>
<p><em>系统：Red Hat 6.3</em></p>
<p><em>网络：千兆光纤</em></p>
<p>.</p>
<p><em>165数据库服务器：</em></p>
<p><em>CPU：8核</em></p>
<p><em>内存：16G</em></p>
<p><em>硬盘：2TB</em></p>
<p><em>系统：Red Hat 4</em></p>
<p><em>网络：百兆光纤</em></p>
<p><strong>数据格式</strong></p>
<p>每条数据包含6个字段。
字段名为:usr, pwd, age, email, address, phone
每个字段均为整形，每个字段内容为当前条数，如：第100条数据，每个字段内容为100。</p>
<p>一、oracle数据库入库测试</p>
<p>数据库环境:165数据库，表结构：hash分区16个，usr字段唯一索引</p>
<p>入库条数：10,000,000</p>
<p>1 单条数据入库</p>
<p>总入库时间2836s（不包含创建连接以及句柄时间）约47.3分钟。</p>
<p>2 批量数据入库</p>
<p>2.1 每批次数据量50,000</p>
<p>总入库时间564s，约9.4分钟。</p>
<p>2.2 每批次数据量100,000</p>
<p>总入库时间553s，约9.2分钟。</p>
<p>二、mongodb入库测试</p>
<p>1 主从备份数据库配置(主从复制)（Master-Slaver）</p>
<p>比较初级的构架，配置简单。</p>
<p>1.1 数据库环境（无索引）</p>
<p>数据库环境：176主节点，175为备份节点，内容时时同步。无索引（索引可以在查询之前建立）。</p>
<p>1.1.1 入库数据量10,000,000</p>
<p>总入库时间355s，约5.9分钟。</p>
<p>从头遍历一次时间13s。</p>
<p>1.1.2 入库数据量50,000,000</p>
<p>总入库时间1815s，约30.25分钟</p>
<p>从头遍历一次时间58s</p>
<p>注：推荐每次插入前删除索引，插入后重新建立索引，减少插入数据时对索引的处理时间。</p>
<p>1.2 数据库环境（有索引）</p>
<p>数据库环境：176主节点，175为备份节点，内容时时同步。usr字段索引。先建立索引</p>
<p>1.2.1 入库数据量10,000,000</p>
<p>总入库时间418s，约6.97分钟。</p>
<p>从头遍历一次时间11s。</p>
<p>1.2.2 入库数据量50,000,000（放弃）</p>
<p>入库25,000,000数据大概1小时，后续时间持续增长，速度过慢。</p>
<p>注：网上资料提供说：这种先写后读的需求，完全可以等全部插入后再建索引，防止大量的锁竞争。</p>
<p>2 mongodb高可用性架构—Replica Set (副本集)</p>
<p>2.1 数据库环境</p>
<p>数据库环境：主节点10.4.120.176:27017，从节点10.4.120.175:27017，仲裁节点10.4.120.176:17017。</p>
<p>作用：当主节点宕机或停电，从节点与仲裁节点进行投票，选择票数大于总主机数一半的从主机为新的主节点。保证服务正常运转。</p>
<p>2.1.1 入库数据量50,000,000(无索引)</p>
<p>总入库时间2348s，约39.5分钟。</p>
<p>从头遍历一次时间58s。</p>
<p>注：</p>
<p>1.大部分网络上的构架应该是这种的升级版（主要为后期数据库调优）。</p>
<p>2.入库后新建索引大概时间为5分钟。</p>
<p>3 MongoDB分布式主备集群架构</p>
<p>本架构为2章节介绍中1和2架构的结合</p>
<p>集群子集r0主备：主服务器176:10000，备服务器175:20000，仲裁服务器176:10001。</p>
<p>集群子集r1主备：主服务器175:10000，备服务器176:20000，仲裁服务器175:10001。</p>
<p>将r0，r1子集架构为分布式集群，自动分片。</p>
<p>3.1.1 入库数据量10,000,000</p>
<p>总入库时间618s，约10.3分钟。</p>
<p>从头遍历一次时间34s。</p>
<p>本次测试包含：插入过程中将某个子集主节点kill掉模拟服务器故障，过1分钟后重新启动该节点主服务器进程，持续插入进程继续，当最后插入结束时，数据丢失1条。</p>
<p>3.1.2 入库数据量20,000,000</p>
<p>多进程入库，每个进程入库10,000,000</p>
<p>总入库时间1315s，约21.9分钟。</p>
<p>3.1.3 入库数据量50,000,000</p>
<p>总入库时间2771s，约46.2分钟。</p>
<p>从头遍历一次时间160s。</p>
<p>三、总结</p>
<p>通过下方的表格可以看出，当处理数据多时，MongoDB效率基本不会改变，而OracleDB效率慢的地方是执行sql语句的时间，当某些业务需求必须单独执行sql时，MongoDB的效率约为OracleDB的5倍。</p>
<p>其中商业架构主推分布式主备集群的架构方式，此方式可以实现数据时时备份，且数据分布式存储，可以实现当某一台主机宕机，无需暂停业务处理。数据丢失情况，为宕机前100ms内执行的数据，约为数据的千万分之一。</p>
<p>个人认为MongoDB单机的效率虽然非常高，但可用性低，而分布式架构适合数据重要性不强情况，能实现远超oracle的效率，分布式主备架构是可用性、安全性最高的架构方式，前期的效率可能会等同于oracle，但当数据量过大时，会超过oracle效率。实现水平扩展，将计算能力提升到最大。</p>
<!-- raw HTML omitted -->
    </section>
</article>
<section class="read-more">
    
    <div class="read-more-item">
        <span class="read-more-item-dim">最近的文章</span>
        <h2 class="post-list__post-title post-title"><a href="/posts/task-with-thread/" title="link to 基于类成员函数回调的线程池-连接池-任务队列">基于类成员函数回调的线程池-连接池-任务队列</a></h2>
        <p class="excerpt"><p>在现实生活中，经常会用到线程池与队列的应用，所以写了一套可复利用接口。</p>
<p>其中优先级队列的蓝本从stl中复制出来的，唯一修改的地方就是添加了一个写锁，当top时加锁，pop后才解锁，保证真正不重复取出或丢失数据。
因为使用模板来构造，所以目前只支持类成员函数的回调。
与线程池共同使用时，外部调用时，需要new一个任务类来添加到队列中，线程池主函数会调用完成后自动delete析构。</p>
<p>此基于成员函数回调的线程池需要同优先级队列共同使用，原理是初始化一个初始为5个线程的线程池，并将自己的控制线程添加到最 …</p>&hellip;</p>
        <div class="post-list__meta">
            <time datetime=" 2013-08-26 00:00:00 &#43;0800" class="post-list__meta--date date">2013-11-28</time>
             <span class="post-list__meta--tags tags">   • <a href="https://sohunjug.com/tags/thread">Thread</a>   • <a href="https://sohunjug.com/tags/pool">Pool</a>   • <a href="https://sohunjug.com/tags/task">Task</a>   • <a href="https://sohunjug.com/tags/c/c&#43;&#43;">C/C&#43;&#43;</a>  </span> 
            <a class="btn-border-small" href="/posts/task-with-thread/">继续阅读</a>
        </div>
    </div>
    


    
    <div class="read-more-item">
        <span class="read-more-item-dim">更早的文章</span>
        <h2 class="post-list__post-title post-title"><a href="/posts/mac-fan-control/" title="link to MacBook Pro – Fan Control">MacBook Pro – Fan Control</a></h2>
        <p class="excerpt"><p>这篇文章主要介绍了在Mac OS X 10.8.4、Ubuntu 13.04 x64和Windows 7 x64三个系统平台下对MacBook Pro（以下简称：MBP）的风扇控制，因为不知道为什么的原因，我个人和不少人的MBP都表现出风扇调速迟钝的问题，通常都是2000RPM左右，然后等到机器超过90摄氏度后风扇开始提速到6000RPM进行散热，但这个肯定不是我们需要的效果，我们要的是，要么自己控制，要么自动调整。</p>
<p>目前，本人的电脑装的是三系统共存，就是Mac OS X …</p>&hellip;</p>
        <div class="post-list__meta">
            <time datetime=" 2013-08-26 00:00:00 &#43;0800" class="post-list__meta--date date">2013-07-26</time>
             
            <span class="post-list__meta--tags tags"> 
                  • <a href="https://sohunjug.com/tags/mac">Mac</a>  
            </span>
            
            <a class="btn-border-small" href="/posts/mac-fan-control/">继续阅读</a>
        </div>
    </div>
    
 </section>
 
<section class="post-comments">
    
      <div id="disqus_thread"></div>
      <script>
      
      var disqus_config = function () {
          this.page.url = "https:\/\/sohunjug.com\/posts\/mongodb-oracle\/";
          this.page.identifier = "https:\/\/sohunjug.com\/posts\/mongodb-oracle\/";
      };
  
      var disqus_shortname = 'sohunjug';
      
      (function() { 
          var d = document, s = d.createElement('script');
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
              (d.head || d.body).appendChild(s);
          })();
      </script>
      <noscript>To view comments from<a href="http://disqus.com/?ref_noscript"> Disqus </a>, please enable JavaScript.</noscript>
      
    

    
    
  </section>
  

        <section class="footer">
    <footer>
        <span class="footer__copyright">本站点内容基于 <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 协议发布。</span>
        <span class="footer__copyright">由 <a href="https://gohugo.io/">Hugo</a> 于 2023-01-05 生成， 采用 <a href="https://github.com/xslingcn/vno-hugo"> Vno - Hugo</a> 作为主题。</span>
    </footer>
</section>

    </div>
  </div>

  <script type="text/javascript" src="//code.jquery.com/jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="/js/main.js"></script><script>
    (function(i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function() {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'your_ga_id', 'your_host');
    ga('send', 'pageview');
</script>

  
</body>

